!function(t,e,i,s,n){"use strict";var o="a-IconList",a="a-IconList-item",r="."+a,l="u-selector",h=l+" "+l+"--single",c="."+l,d="is-selected",u="."+d+r,f="is-focused",g="is-disabled",m="aria-selected",p="aria-multiselectable",v="aria-labelledby",b="role",C="tabindex",y="u-RTL",_=n.ui.keyCode,x=0;function w(t){return t.parent().children().index(t)}function I(t){var e=t.find("a");return e.length?e[0]:t[0]}function F(t){return n(t).closest(r)}var S={begin:function(){this.text="<ul>\r\n"},item:function(t,e,i){this.text+="<li>"+s.escapeHTML(i)+"</li>\r\n"},end:function(){this.text+="</ul>\r\n"},toString:function(){return this.text}};n.widget("apex.iconList",n.extend(!0,{widgetEventPrefix:"iconlist",options:{multiple:!1,itemSelector:!1,addItemSelector:!0,label:!0,navigation:!1,tabbableContent:null,noNavKeyContent:null,allowCopy:!0,dataTransferFormats:[{format:"text/plain",writer:Object.create({begin:function(){this.text=""},item:function(t,e,i){e>0&&(this.text+="\r\n"),this.text+=i},end:function(){},toString:function(){return this.text}})},{format:"text/html",writer:Object.create(S)}],selectionChange:null,activate:null},_create:function(){var t,i=this,r=this.options,l=this.element;this.columns=0,this.rows=0,this.searchString="",this.searchTimerId=null,r.navigation&&(r.multiple=!1),l.addClass(o).attr(b,"listbox"),r.multiple&&l.attr(p,"true"),this.forwardKey=_.RIGHT,this.backwardKey=_.LEFT,"rtl"===l.css("direction")&&(l.addClass(y),this.forwardKey=_.LEFT,this.backwardKey=_.RIGHT),l.attr(v)?(t=n("#"+l.attr(v).split(" ").join(",#")).last(),this.infoId=t.attr("id")+"_info",t.append("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>")):(x+=1,this.infoId=(l.attr("id")||"il"+x)+"_info",l.before("<span id='"+this.infoId+"' class='u-VisuallyHidden'></span>"),l.attr(v,this.infoId),this.addedLabel=!0),this._initContextMenu(a,(function(){return!1}),(function(t){var e=F("keydown"===t.type&&i.lastFocused?i.lastFocused:t.target);return!!e.length&&(!!e.hasClass(d)||e)})),this._on(this._eventHandlers),r.allowCopy&&e.addHandler(l[0],(function(t){return i._copy(t),!0})),this._selNotifyDelay=s.debounce(this._selChangeNotify,1),this._selNotifyLongDelay=s.debounce(this._selChangeNotify,350),this.refresh(),r.disabled&&this._setOption("disabled",r.disabled)},_eventHandlers:{resize:function(t){t.target===this.element[0]&&(this._dim(),t.stopPropagation())},click:function(t){var e,i=this.options,s=i.navigation,o=n(t.target);s&&o.closest("a").length>0&&(t.shiftKey||t.ctrlKey)||(e=o.closest(r)).length&&(i.itemSelector&&o.closest(c).length&&(t.ctrlKey=!0,t.shiftKey=!1),this._select(e,t,!0,!1),s&&this._activate(t),!s&&i.tabbableContent&&o.closest(i.tabbableContent).length?i.tabbableContent&&o.closest(i.tabbableContent).length&&o.trigger("focus"):t.preventDefault())},dblclick:function(t){this.options.navigation||F(t.target).length&&this._activate(t)},mousedown:function(t){t.preventDefault()},keydown:function(t){var e,i,s,o=this.element,a=this.options,r=n(t.target),l=null,h=t.which;!a.navigation&&a.noNavKeyContent&&r.closest(a.noNavKeyContent).length||(h===_.HOME?l=o.children().first():h===_.END?l=o.children().last():h===_.DOWN?this.lastFocused&&(e=this._index2RowCol(w(F(this.lastFocused))),i=o.children(),e.row<Math.floor((i.length-1)/this.columns)&&((s=this._rowCol2Index(e.row+1,e.column))>=i.length&&(s=i.length-1),l=i.eq(s))):h===_.UP?this.lastFocused&&(e=this._index2RowCol(w(F(this.lastFocused))),i=o.children(),(s=this._rowCol2Index(e.row-1,e.column))>=0&&(l=i.eq(s)),l&&t.stopPropagation()):h===this.backwardKey?this.lastFocused&&(l=F(this.lastFocused).prev()):h===this.forwardKey?this.lastFocused&&(l=F(this.lastFocused).next()):h===_.SPACE?this.lastFocused&&!this.searchTimerId&&(l=F(this.lastFocused)):h===_.ENTER&&"A"!==t.target.nodeName&&this._activate(t),l&&l[0]&&(this._select(l,t,!0,!0),t.preventDefault()))},keypress:function(t){var e,i,s=this.options,o=this;if(0!==t.which&&s.label&&!t.altKey&&!t.ctrlKey&&(s.navigation||!s.noNavKeyContent||!n(t.target).closest(s.noNavKeyContent).length)){if(e=String.fromCharCode(t.which).toLowerCase(),this.searchTimerId)e!==this.searchString&&(this.searchString+=e),clearTimeout(this.searchTimerId),this.searchTimerId=null;else{if(" "===e)return;this.searchString=e}this.searchTimerId=setTimeout((function(){o.searchTimerId=null}),500),(i=this._findItem(this.searchString))&&this._select(i,t,!0,!0)}},focusin:function(t){var e=F(t.target);0!==e.length&&(e.addClass(f),this._setFocusable(t.target))},focusout:function(t){F(t.target).removeClass(f)}},_destroy:function(){var t=this.element,i=this.options;t.removeClass(o+" "+g+" "+y).removeAttr(b).removeAttr(p).children().removeClass(a).removeAttr(b).removeAttr(m).removeAttr(C),t.find("a").removeAttr(C).removeAttr(b),i.itemSelector&&i.addItemSelector&&t.find(c).remove(),e.removeHandler(t[0]),this._destroyContextMenu(),n("#"+this.infoId).remove(),this.addedLabel&&t.removeAttr(v)},_setOption:function(t,e){var i,s,n=this.options,o=this.element;if(this._checkContextMenuOptions(t,e),"multiple"===t)n.navigation&&(e=!1);else if("allowCopy"===t||"addItemSelector"===t||"navigation"===t)throw new Error("IconList "+t+" option cannot be set");this._super(t,e),"disabled"===t?(o.toggleClass(g+" ui-state-disabled",e).attr("aria-disabled",e),this.lastFocused&&(e?this.lastFocused&&((i=!n.navigation&&n.tabbableContent)?(s=F(this.lastFocused)).add(s.find(i).not(":disabled")).prop("tabIndex",-1):this.lastFocused.tabIndex=-1):this._setFocusable(this.lastFocused)),e&&this._dim()):"multiple"===t?e?o.attr(p,"true"):o.removeAttr(p):"itemSelector"===t&&this.refresh()},refresh:function(){var t,e,i,s=this.options,o=this.element;s.multiple&&!s.itemSelector&&apex.userHasTouched()&&(s.itemSelector=!0,s.addItemSelector=!0),o.find("a").attr(C,-1).attr(b,"option"),o.find(s.tabbableContent).attr(C,-1),(i=o.children()).addClass(a).filter((function(){return 0===n(this).find("a").length})).attr(b,"option").attr(C,-1),s.addItemSelector&&(s.itemSelector?(e=n("<span class='"+(s.multiple?l:h)+"'></span>"),i.filter((function(){return n(this).find(c).length<=0})).prepend(e)):o.find(c).remove()),this._dim(),(t=o.find(u)).length>0?this.setSelection(t,!1):(this.lastFocused&&n(this.lastFocused).is(":visible")||(this.lastFocused=I(o.children().first())),this.selectAnchor=this.lastFocused,this.lastFocused&&!s.disabled&&this._setFocusable(this.lastFocused))},resize:function(){this._dim()},focus:function(){this.lastFocused&&this.lastFocused.focus()},getColumns:function(){return this.columns},getRows:function(){return this.rows},getSelection:function(){return this.element.find(u)},getSelectionValues:function(){var t=[];return this.getSelection().each((function(){t.push(n(this).attr("data-value"))})),t},setSelection:function(t,e,i){e=!!e,this._select(t,null,e,!1,i)},_copy:function(t){var e,i,s=this.getSelection(),n=this.options.dataTransferFormats;if(s.length){for(n.forEach((function(t){t.writer.begin(s)})),e=0;e<s.length;e++)i=s.eq(e),n.forEach((function(t){t.writer.item(i,e,i.text())}));n.forEach((function(e){e.writer.end(),t.setData(e.format,e.writer.toString())}))}},_rowCol2Index:function(t,e){return t*this.columns+e},_index2RowCol:function(t){var e=Math.floor(t/this.columns);return{row:Math.floor(t/this.columns),column:t-e*this.columns}},_dim:function(){var t,e,s,o=this,a=this.element,r=a.width(),l=a.children(),h=l.length;h&&(t=l.first().position().top,s=l.first().outerWidth()),this.columns=h,l.each((function(e){var i=n(this).position().top;if(i>t)return t=i,o.columns=e,!1})),this.rows=h>0?Math.floor((h+this.columns-1)/this.columns):0,1===this.rows&&(this.columns=Math.floor(r/s)),e=1===this.columns?i.formatMessage("APEX.ICON_LIST.LIST_DIM",this.rows):i.formatMessage("APEX.ICON_LIST.GRID_DIM",this.columns,this.rows),n("#"+this.infoId).text(e)},_findItem:function(t){var e,i,s=this.element,n=t.length,o=this.options.label;for(e=i=F(this.lastFocused),1===n&&(e=e.next()),0===e.length&&(e=s.children().first());e.length>0;){if((!0===o?e.text().trim():e.find(o).text()).substring(0,n).toLowerCase()===t)return e;if(0===(e=e.next()).length&&(e=s.children().first()),e[0]===i[0])break}return null},_setFocusable:function(t){var e,i=this.options,s=!i.navigation&&i.tabbableContent;this.lastFocused&&this.lastFocused!==t&&(s?(e=F(this.lastFocused)).add(e.find(s).not(":disabled")).prop("tabIndex",-1):this.lastFocused.tabIndex=-1),s?(e=F(t)).find(s).not("disabled").prop("tabIndex",0).length||e.prop("tabIndex",0):t.tabIndex=0,this.lastFocused=t},_activate:function(t){var e,i;this._trigger("activate",t,{values:this.getSelectionValues()}),this.options.navigation&&!t.isDefaultPrevented()&&(i=(e=this.getSelection()).attr("href")||e.find("a").attr("href"))&&(t.preventDefault(),apex.navigation.redirect(i))},_select:function(t,e,i,o,a){var r,l,h,f,g,p,v,b,C,y="set",_=this.element,x=this.options,F=_.find(u);t=t.filter(":visible"),e&&x.multiple&&("click"===e.type?e.ctrlKey||e.metaKey?y="toggle":e.shiftKey&&(y="range"):"keydown"===e.type&&(e.keyCode===n.ui.keyCode.SPACE?y=e.ctrlKey?"toggle":e.shiftKey?"range":"add":e.ctrlKey?y="none":e.shiftKey&&(y="range"))),"range"!==y||this.selectAnchor||(y="set"),"set"!==y&&"range"!==y||F.removeClass(d).removeAttr(m).find(c).removeClass(d),r=t.hasClass(d),"set"===y||"add"===y||"toggle"===y&&!r?(t.addClass(d).attr(m,!0).find(c).addClass(d),this.selectAnchor=t[0]):"range"===y?(_.children().removeClass(d).removeAttr(m).find(c).removeClass(d),p=w(n(this.selectAnchor)),v=w(t.last()),p>v&&(b=v,v=p,p=b),_.children().filter((function(t){return t>=p&&t<=v})).addClass(d).attr(m,!0).find(c).addClass(d)):"toggle"===y&&r&&(t.removeClass(d).removeAttr(m).find(c).removeClass(d),this.selectAnchor=t[0]),t.length>0&&(C=I(t.first()),i?(C.tabIndex=0,C.focus()):this._setFocusable(C),(f=(h=_.scrollParent())[0]===document?{left:0,top:0}:h.offset())&&(g=_.offset(),((l=t.first().offset()).top<f.top||l.top>f.top+h[0].offsetHeight)&&(h[0].scrollTop=l.top-g.top),(l.left+t[0].offsetWidth<f.left||l.left>f.left+h[0].offsetWidth)&&(h[0].scrollLeft=l.left-g.left))),a||x.navigation&&e&&"click"===e.type||("toggle"===y||"range"===y&&!r||"add"===y&&!r||"set"===y&&!s.arrayEqual(F,t))&&(o?this._selNotifyLongDelay(e):this._selNotifyDelay(e))},_selChangeNotify:function(t){this.element.hasClass(o)&&this._trigger("selectionChange",t)}},apex.widget.contextMenuMixin))}(apex.debug,apex.clipboard,apex.lang,apex.util,apex.jQuery);